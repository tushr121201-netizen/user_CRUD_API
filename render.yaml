services:
  - type: web
    name: crud-api
    env: node
    plan: free
    buildCommand: npm install
    startCommand: npm start
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: crud-db
          property: connectionString
      - key: REDIS_URL
        fromService:
          type: redis
          name: crud-redis
          property: connectionString
      - key: PORT
        value: 10000

databases:
  - name: crud-db
    databaseName: crud
    user: crud_user
    plan: free
    ipAllowList: [] # Allow all IPs for demo purposes

# Render doesn't support managed Redis in the free tier via yaml easily sometimes, 
# but this is the standard way to define it if available or use an external Redis provider.
# If managed redis is creating issues, use an external provided URL.
